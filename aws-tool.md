## オンプレ Web アプリの AWS 移行および toC メディアの AWS 移行におけるテスト故障対応

### 案件概要

不動産情報系サイト運営企業様の、toC メディアサービス基盤の AWS 移行案件

### 担当

クライアント企業様内のユーザー部門向けツール(Web アプリ)の AWS 移行を担当しました。特にミッションクリティカルな要求はなく、現行アプリ自体も、1 つのサーバーに Web サーバー(IIS)/アプリ本体(PHP)/ユーザー管理 DB(MySQL) が同居しているような、ちょっとしたツールだったので、作業要員としては自分 1 人で進めていました。

#### 自動バックアップ

機能追加として、自動バックアップ機能を実装しました。まずバックアップ対象について検討した結果、定時バックアップが必要なリソースは、本アプリ内に同居した MySQL DB と 操作/アクセスログ だけでした。MySQL のデータについて、相談したところ「更新がまれで、かつ、行列数も非常に少なく、万が一消失したとしても手入力で十分対応可能」とのことだったので、バックアップ方法は「毎日定時に MySQL のダンプを作成し、ログと一緒に AWS CLI を使って S3 にアップロードする」シェルスクリプトを cron で動かす、という仕組みにしました。本当にバックアップの必要なリソースを検討し、 EBS や AMI ごとバックアップを取る方法を回避したことで、世代管理の設定をしなくていいなど運用をシンプルにすることができたかなと思います。

#### テスト

テストでは Puppeteer という ヘッドレス Chrome を扱える Node.js のライブラリを使用したのですが、これはちょうど前の案件で自動テストツールの存在を知ったところで、要件がマッチする本案件に参画できたので、この機会に使ってみて知見を貯めよう、ということで、自分から導入の提案をしたものでした。ここでの自動テスト経験が次の案件への引き合いになったのかなと思っていて、チャレンジしてよかったです。
